"use strict";(()=>{var e={};e.id=740,e.ids=[740],e.modules={8802:e=>{e.exports=require("bcrypt")},1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8318:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>A,patchFetch:()=>j,requestAsyncStorage:()=>q,routeModule:()=>x,serverHooks:()=>U,staticGenerationAsyncStorage:()=>w});var n={};t.r(n),t.d(n,{POST:()=>v});var i=t(408),o=t(3846),s=t(3899),a=t(6740),p=t(7269),u=t(5727),d=t(8802),l=t.n(d);let g=require("node:crypto");var c=t.n(g);let m={randomUUID:c().randomUUID},f=new Uint8Array(256),y=f.length,S=[];for(let e=0;e<256;++e)S.push((e+256).toString(16).slice(1));let h=function(e,r,t){if(m.randomUUID&&!r&&!e)return m.randomUUID();let n=(e=e||{}).random||(e.rng||function(){return y>f.length-16&&(c().randomFillSync(f),y=0),f.slice(y,y+=16)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,r){t=t||0;for(let e=0;e<16;++e)r[t+e]=n[e];return r}return function(e,r=0){return(S[e[r+0]]+S[e[r+1]]+S[e[r+2]]+S[e[r+3]]+"-"+S[e[r+4]]+S[e[r+5]]+"-"+S[e[r+6]]+S[e[r+7]]+"-"+S[e[r+8]]+S[e[r+9]]+"-"+S[e[r+10]]+S[e[r+11]]+S[e[r+12]]+S[e[r+13]]+S[e[r+14]]+S[e[r+15]]).toLowerCase()}(n)};async function v(e){try{let r;let{email:t,password:n}=await e.json();if(!t||!n)return a.NextResponse.json({error:"All fields are required."},{status:400});if((r=await p.Z.findOne({email:t}))||(r=await u.Z.findOne({email:t})),!r)return a.NextResponse.json({error:"User not found."},{status:404});if(!await l().compare(n,r.password))return a.NextResponse.json({error:"Invalid password."},{status:401});let i=h(),o=a.NextResponse.json({message:"Login successful.",role:r instanceof p.Z?"attendee":"organizer"});return o.cookies.set("sessionId",i,{httpOnly:!0,maxAge:3600,path:"/"}),o}catch(e){return console.error("Login error:",e),a.NextResponse.json({error:"Server error."},{status:500})}}let x=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/login/route",pathname:"/api/login",filename:"route",bundlePath:"app/api/login/route"},resolvedPagePath:"C:\\Users\\Cs-Store\\OneDrive - Assumption University\\Desktop\\Final Archive\\app\\api\\login\\route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:q,staticGenerationAsyncStorage:w,serverHooks:U}=x,A="/api/login/route";function j(){return(0,s.patchFetch)({serverHooks:U,staticGenerationAsyncStorage:w})}},7269:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(1185),i=t.n(n);let o=new n.Schema({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,default:"attendee"},profilePicture:{type:String},id:{type:String},phone:{type:String}},{timestamps:!0}),s=n.models.Attendee||i().model("Attendee",o)},5727:(e,r,t)=>{t.d(r,{Z:()=>s});var n=t(1185),i=t.n(n);let o=new n.Schema({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},role:{type:String,default:"organizer"},bio:{type:String},profilePicture:{type:String},id:{type:String},phone:{type:String}},{timestamps:!0}),s=n.models.Organizer||i().model("Organizer",o)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[909,218],()=>t(8318));module.exports=n})();